---
description: 容器技术是全球 IT 基础设施变革的基石
---

# 前言

容器技术源于一家PaaS公司为了解决用户应用分发的问题而推出的开源工具 Docker。它的核心创新点在于让应用环境依赖库和应用包打包在一起成为一个镜像，通过分发镜像来部署应用。真正让应用可以做到一次构建，多次部署的梦想。随着企业业务需求的不断增长，对容器、微服务、开发运维实践\( DevOps \)等新型软件领域提出了更多期望和要求。为了适应业务的高速发展的诉求，各个技术团队开始拥抱开源软件，纷纷利用容器技术来构建自己的企业基础设施。在『云原生』建设这条路上，采用公有云如亚马逊、阿里云的应用标准组件方案，也只是解决企业的部分扩展组件的问题，对于全局的架构敏捷变化的需求，仍然需要技术开发团队搭建自己的应用管理平台。为了更好的管理内部工具的生命周期，提高企业投入的回报率，大部分企业的开发团队会选择业界知名的开源技术来解决自身问题。在容器这个领域，大家逐渐注意到以 Docker、Kubernetes 为核心的优秀开源工具链可以帮助开发者在有限资源投入的情况下就可以构建出标准的企业应用发布管理平台，这给企业开发团队在落地容器技术上给予了极大的信心。容器技术经过了差不多六年时间的高速发展，云计算的头部领导企业如 Google 、红帽、 VMware等在 Linux 基金会的组织下发起了云原生计算基金会（CNCF），并开始主导云计算领域的企业级开源软件项目的孵化和认证工作，帮助企业搭建行业认可的云原生应用基础设施平台。

## 本书特点

本书从容器工具 Docker 开始，帮助读者了解容器技术的核心概念，拆解容器技术对 Linux Kernel 组件的应用，帮助读者对容器应用的启动流程、Linux内核系统知识加深熟悉，真正掌握容器运行的整个生命过程。笔者结合自身一线的落地容器技术切身实践经验，系统性的整理出对应用容器化有帮助的实践思路和方法。在孕育构思这样一本实践工具书的过程中，笔者经历了2015年在 InfoQ 技术大会上介绍容器技术时感受到的强烈学习热潮；2016年国内企业开始在落地容器化应用中遇到各种 Docker 工具链的不兼容问题；2017年国内企业开始全面转向CNCF云原生基金会支持下的容器工具链 Kubernetes 生态中；再到2018年容器技术开始百花齐放，国内企业在应用容器化过程中技术栈的选择太多，不知如何落地等问题。这些现象都反应了一个事实：国内企业在落地容器技术的过程中已经走在了全球企业发展的前列，我们很难从国际主流的容器技术公司例如 Docker 公司获得切实可行的企业级落地方案。在这样的大背景下，大量的国内企业容器技术的经验积累分享反而成为业界主流的容器技术落地的第一手资料。所以，本书的容器技术理论基础和实践经验都是来自整理国内容器技术社区的分享资料，通过整理迭代而汇聚的一本能讲清楚问题并能拿出技术落地参考的书。

## 读者群体

适合本书的读者群体包括

* 有一定编程经验，想要学习容器技术的初学者
* 对传统运维有一定了解，还想对云原生应用运维深入学习的进阶者

本书不适合完全没有编程基础的人学习

## 如何阅读本书

从实践的角度来看，把应用打包成容器镜像，并部署到容器集群这个过程是大家最基本的学习需求。但是因为容器运行之后，整个生命周期的管理仍然需要规划和自动化处理才能支撑业务运行需要。所以，不管你是要实现持续集成、持续发布还是持续部署，怎么把容器技术注入进去都需要花点心思来学习才能掌握它。首先，从最基本的Docker命令行工具开始熟悉是最佳选择，然后是Kubernetes命令行工具kubectl的使用介绍。这些都是容器技术使用过程中最常见的命令行工具。有了这些容器工具的使用经验之后，我们开始探讨容器核心技术的关键点：虚拟化性能和隔离性。作为新一代的虚拟化技术，容器技术基于Linux Kernel的Cgroup和Namespace的支持，以进程的角度来虚拟化应用，并且在隔离性上也能获得和真实虚拟化技术KVM等类似的效果。因为去掉了对Hypervisor的依赖，虚拟化性能各项指标可以更强，虚拟化的密度可以更大，这些优点也是容器技术最吸引人的地方。

在我们预览完容器核心技术之后，就会转向一个更实际的话题，也就是如何在DevOps实践中应用容器技术。我觉得这里面最有意思的第一个问题是，容器技术的推广到底是由运维人员推动的还是由开发人员推动的。我们从利弊分析中可以知道，因为要推广容器技术，运维需要学习掌握大量Linux Kernel的开发知识才能掌握容器技术，这对运维人员来说无疑增加了很大的学习负担和工作成本。从开发人员来说，除了前期的容器文件Dockerfile的编写，基本上开发并没有什么工作量，并且因为用了容器技术，开发可能更多的是专注开发环境的开发，把大量是适配容器技术的工作推给了运维人员。因为业务复杂度的不断提高，如果运维人员不调整心态拥抱变化是无法适应容器技术的落地需要的。所以，容器运维的人员的工作职责更重，自动化运维开发的需求越多，也催生了运维圈里的新角色，运维架构师，国外对应的职位名称为SRE\(Site Reliability Engineer\)。有趣的历史巧合是，当前容器技术的主要布道者Google公司也是SRE这个角色的主要布道者。

随着DevOps完整容器技术的落地，我们需要了解如何搭建容器集群Kubernetes平台。在搭建平台的过程中，我们还要涉及到存储、网络、多租户安全配置等多个实际问题的实践。虽然网络上已经有大量的指导手册，我们仍然要清楚的是，如何理解其中的原理并定制化自己需要的集成方案。因为开源技术本身就是提供的组件，作为企业中你需要有这个能力能组装这些软件，并配置出自己需要的容器方案。然后，笔者将通过一个完整的Springboot微服务项目的构建，测试到发布的过程，解读一些业界的最佳实践方法。通过真实案例的分析理解，让读者能对容器技术落地的方方面面有更深入的了解。

从应用分发的角度上来讲，Kubernetes容器技术社区提供了Helm这样的应用打包的仓库，帮助用户能构建自己的应用商店，通过配置可以做到一键安装。在2018年CNCF北美大会上，微软和Docker公司联合发布了增强版本的云原生应用封装规范（CNAB，Cloud Native Application Bundle），让用户可以通过命令行工具就可以维护管理好自己的软件系统包，让应用分发更标准。

除了介绍一些落地集成方面的容器技术，笔者也注意到业界对富容器技术的推出。我们知道传统的虚拟化技术在隔离性上非常强，只是在虚拟化性能上弱于容器技术，那么有没有结合传统虚拟化技术的强项和容器技术的强项，打造的容器技术方案呢。答案就是富容器技术。笔者将介绍3种典型的工具代表如阿里巴巴的Pouch Container，Intel的Kata Container和Google的gVisor技术实践，帮助容器技术的爱好者更深入的了解这些技术的利弊，在实际的业务场景中，可以结合之前的容器技术经验有选择的集成到自己企业的应用开发平台中，这些势必会给你的业务需求落地带来更多的选择。

总而言之，容器技术并非看上去那么简单直白，它包含了众多云计算技术的优点，奠定了云基础设施核心技术之一。读者通过本身整理过的系统性的容器技术，可以在未来的数字化转型的过程中，充分理解容器技术的利弊，更好的服务于企业业务的需要。

## 勘误

因为笔者的技术经验有限，难免在编排整理本书的过程中写入了一些理解错误和描述不准确的问题，请读者在遇到此类问题之后可以统一联系笔者邮箱: xiaods@gmail.com，不胜感激。谢谢。

## 致谢

首先，我要感谢 Mesos，Kubernetes，Docker等社区中每一位帮助过我的朋友，没有你们的奉献，就没有这本书。

感谢我服务过的每一位容器用户的咨询和技术探讨，正因为通过这样的容器实践的讨论，才得以让容器技术更加成熟，并且现在的容器技术已经成为实际的开发运维的事实标准。为此我也要感激曾经与我一起容器创业的战友们，没有你们的努力和支持，本书的实践内容不会如此真实丰富。

然后，我要感谢出版社的编辑。感谢对我的严重拖延症的容忍和等待。让这本书从想法成为现实。

最后，我感觉我的媳妇，我的儿子和闺女的支持。因为家庭的乐趣让我无时无刻不再想让我做的事情变的更有意义。感谢重病的父亲和老母亲对我的理解和支持。正是因为人到中年，才能真正体会到家庭的责任、社会的责任，人的价值的重要性，才使我不断自我成长，努力做好自己的事情让生活变的更美好。







